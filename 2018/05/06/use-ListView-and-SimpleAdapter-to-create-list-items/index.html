<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta name="keywords" content="hexo, autumn" />
    <title>
        FENICE
    </title>
    <!-- favicon -->
    
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/frontendsophie/hexo-theme-autumn@1.0.0/source/img/favicon.ico" />
     
<link rel="stylesheet" href="/css/style.css">


    <!-- highlight -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/github-gist.min.css" />
    <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad()
    </script>
    <script src="https://cdn.jsdelivr.net/gh/frontendsophie/hexo-infinite-scroll@2.0.0/dist/main.js"></script>

    <script>
        infiniteScroll()

        window.addEventListener('DOMContentLoaded', function () {
            const [
                mainTitle,
                mobileMenu,
                mobileMainTitle,
                mobileMenuBtn,
                ipadMenuBtn,
                aside,
                closeBtn,
            ] = getEle(
                '#main-title',
                '.mobile-menu',
                '.mobile-menu h3',
                '.mobile-menu button',
                '.ipad-menu',
                'aside',
                'aside .close',
            )
            const io = new IntersectionObserver(entries => {
                if (entries[0].intersectionRatio <= 0) {
                    mobileMainTitle.classList.remove('invisibile')
                } else {
                    mobileMainTitle.classList.add('invisibile')
                }
            })
            io.observe(mainTitle)

            clickToggleAside(mobileMenuBtn)
            clickToggleAside(ipadMenuBtn)
            clickToggleAside(closeBtn, false)

            const isMenuVisible = window.getComputedStyle(mobileMenu).display !== 'none'
            if (isMenuVisible) document.body.style.background = 'none'

            function getEle(...args) {
                return args.map(arg => document.querySelector(arg))
            }

            function clickToggleAside(btn, show = true) {
                btn.addEventListener('click', function () {
                    if (show) {
                        aside.style.display = 'block'
                    } else {
                        aside.style.display = 'none'
                    }
                })
            }
        })
    </script>
<meta name="generator" content="Hexo 5.0.0"></head>

<body style="background: url(https://cdn.jsdelivr.net/gh/frontendsophie/hexo-theme-autumn@1.0.0/source/img/button-bg.png) #f3f3f3">
    <div class="container">
        <header class="header">
    <nav class="mobile-menu" style="background: url(https://cdn.jsdelivr.net/gh/frontendsophie/hexo-theme-autumn@1.0.0/source/img/button-bg.png) #f3f3f3">
        <h3 class="invisibile">
            <a href="/" class="logo">
                FENICE
            </a>
        </h3>
        <button class="menu">menu</button>
    </nav>

    <button class="ipad-menu menu">menu</button>

    <h1 class="title" id="main-title">
        <a href="/" class="logo">
            FENICE
        </a>
    </h1>
    <h2 class="desc">
        Rock and opera fans
    </h2>

    <div class="links">
        <ul>
            
            <li>
                <a target="_blank" rel="noopener" href="https://github.com/fenicesun">
                    Github
                </a>
            </li>
            
            <li>
                <a target="_blank" rel="noopener" href="https://www.linkedin.com/">
                    LinkedIn
                </a>
            </li>
            
        </ul>
    </div>
</header>
        <main class="main">
            <article class="post">
    
    
    <h4 class="post-cat">
        <a href="/categories/programming/">
            programming
        </a>
    </h4>
    
    
    <h2 class="post-title">
        use ListView and SimpleAdapter to create list items
    </h2>
    <ul class="post-date">
        <li>
            2018-05-06
        </li>
        <li>
            Fenice Sun
        </li>
    </ul>
    <div class="post-content">
        <h3 id="使用ListView和SimpleAdapter创建列表项"><a href="#使用ListView和SimpleAdapter创建列表项" class="headerlink" title="使用ListView和SimpleAdapter创建列表项"></a>使用ListView和SimpleAdapter创建列表项</h3><blockquote>
<p>android开发中，经常使用Adapter把自定义的数据转换并映射到listview中，自定义出复杂列表项以实现自定义的列表效果。</p>
</blockquote>
<h4 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h4><p>　    ListView，列表视图，直接继承了AbsListView，是一个以垂直方式在项目中显示View视图的列表。ListView的数据项，来自一个继承了ListAdapter接口的适配器。
　    </p>
<h4 id="SimpleAdapter"><a href="#SimpleAdapter" class="headerlink" title="SimpleAdapter"></a>SimpleAdapter</h4><p>SimpleAdapter用来将自定义数据绑定到视图</p>
<pre><code>SimpleAdapter(Context context, List&lt;? extends Map&lt;String, ?&gt;&gt; data, int resource, String[] from, int[] to)</code></pre>
<ul>
<li>Context context:上下文(当前的Activity)</li>
<li>List<? extends Map<String, ?>&gt; data:一个嵌套Map集合类型的list集合数据源</li>
<li>int resource:这个是你设定用于接收Map-Object类型的Activity,这个布局中必须包括了to中定义的控件id</li>
<li>String[] from:第四个参数通过源码可以看出需要的是一个K值的字符串数组</li>
<li>int[] to:第五个参数通过源码看出是一个与K值匹配的的控件对象</li>
</ul>
<blockquote>
<p>这里我们实现一个类似于微信聊天的列表页</p>
</blockquote>
<img src="list.png" style="border:none;">

<h4 id="Activity类"><a href="#Activity类" class="headerlink" title="Activity类"></a>Activity类</h4><pre><code>核心逻辑，加载控件并将数据组合好转换成adapter对象，用listView来加载adapter</code></pre>
<pre><code>public class MainActivity extends AppCompatActivity &amp;#123;

    private int[] imgIds = new int[] &amp;#123;
        R.mipmap.jordan, R.mipmap.kobe, R.mipmap.george
    &amp;#125;;

    private String[] names = new String[] &amp;#123;
            &quot;乔丹&quot;, &quot;科比&quot;, &quot;乔治&quot;
    &amp;#125;;

    private String[] words = new String[] &amp;#123;
        &quot;篮球之神&quot;, &quot;黑曼巴&quot;, &quot;泡椒&quot;
    &amp;#125;;

    private List&lt;Map&lt;String, Object&gt;&gt; players = new ArrayList&lt;Map&lt;String, Object&gt;&gt;();

    private ListView playersView;

    private SimpleAdapter adapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) &amp;#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        initPlayerRecords();

        adapter = new SimpleAdapter(
                this,
                players,
                R.layout.player_item,
                new String[] &amp;#123;&quot;imghead&quot;, &quot;name&quot;, &quot;word&quot;&amp;#125;,
                new int[] &amp;#123;R.id.imghead, R.id.name, R.id.words&amp;#125;);

        playersView = (ListView)findViewById(R.id.player_list);
        playersView.setAdapter(adapter);

        playersView.setOnItemClickListener(new AdapterView.OnItemClickListener() &amp;#123;
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &amp;#123;
                Map&lt;String, Object&gt; map = players.get(position);
                String str = &quot;&quot;;
                str += map.get(&quot;name&quot;) + &quot;---&quot; + map.get(&quot;word&quot;) + &quot;\n&quot; + &quot;长按删除&quot;;
                Toast.makeText(MainActivity.this, str, Toast.LENGTH_SHORT)
                        .show();
            &amp;#125;
        &amp;#125;);

        playersView.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() &amp;#123;
            @Override
            public boolean onItemLongClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &amp;#123;
                players.remove(position);
                adapter.notifyDataSetChanged();
                Toast.makeText(MainActivity.this, &quot;删除成功!&quot;, Toast.LENGTH_SHORT)
                        .show();
                return false;
            &amp;#125;
        &amp;#125;);
    &amp;#125;

    public void initPlayersRecords() &amp;#123;
        for (int i = 0; i &lt; names.length; i++) &amp;#123;
            Map&lt;String, Object&gt; record = new HashMap&lt;String, Object&gt;();
            record.put(&quot;imghead&quot;, imgIds[i]);
            record.put(&quot;name&quot;, names[i]);
            record.put(&quot;word&quot;, words[i]);
            players.add(record);
        &amp;#125;
    &amp;#125;
&amp;#125;
</code></pre>
<h4 id="ListView主布局文件"><a href="#ListView主布局文件" class="headerlink" title="ListView主布局文件"></a>ListView主布局文件</h4><pre><code>activity_main中放置listview的布局</code></pre>
<pre><code>&lt;ListView
        android:id=&quot;@+id/player_list&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;&gt;

&lt;/ListView&gt;</code></pre>
<h4 id="具体列表项的布局文件"><a href="#具体列表项的布局文件" class="headerlink" title="具体列表项的布局文件"></a>具体列表项的布局文件</h4><pre><code>复杂列表项需要用自定义布局，以实现想要的UI效果</code></pre>
<pre><code>&lt;LinearLayout
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;horizontal&quot;&gt;

    &lt;ImageView
        android:id=&quot;@+id/imghead&quot;
        android:layout_width=&quot;64dp&quot;
        android:layout_height=&quot;64dp&quot;
        android:baselineAlignBottom=&quot;true&quot;
        android:paddingLeft=&quot;8dp&quot; /&gt;

    &lt;LinearLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;vertical&quot; &gt;

        &lt;TextView
            android:id=&quot;@+id/name&quot;
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:paddingLeft=&quot;8dp&quot;
            android:textColor=&quot;#1D1D1C&quot;
            android:textSize=&quot;20sp&quot; /&gt;

        &lt;TextView
            android:id=&quot;@+id/words&quot;
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:paddingLeft=&quot;8dp&quot;
            android:textColor=&quot;#B4B4B9&quot;
            android:textSize=&quot;14sp&quot; /&gt;
    &lt;/LinearLayout&gt;
&lt;/LinearLayout&gt;</code></pre>
<p>这样就实现图中的聊天列表效果了。</p>

    </div>
</article>
        </main>
        <aside class="aside">
            <div class="close"></div>
            <section class="aside-section">
                
    <h1>Categories</h1>

    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Science/">Computer Science</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">diary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/financial-mathematics/">financial mathematics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/reading-notes/">reading notes</a></li></ul>

            </section>
            <section class="aside-section">
                
    <h1>Archives</h1>

    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a></li></ul>


            </section>
            <section class="aside-section tag">
                
    <h1>Tags</h1>

    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2017/" rel="tag">2017</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/2018/" rel="tag">2018</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/2019/" rel="tag">2019</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSAPP/" rel="tag">CSAPP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/I-O/" rel="tag">I/O</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/autumn/" rel="tag">autumn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/" rel="tag">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code/" rel="tag">code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/" rel="tag">cpp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/discipline/" rel="tag">discipline</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/epoll/" rel="tag">epoll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fork/" rel="tag">fork</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/freedom/" rel="tag">freedom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gcc/" rel="tag">gcc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/interest/" rel="tag">interest</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/" rel="tag">lambda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manjianghong/" rel="tag">manjianghong</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memory/" rel="tag">memory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/model/" rel="tag">model</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/moon/" rel="tag">moon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/night/" rel="tag">night</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plot/" rel="tag">plot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pointer/" rel="tag">pointer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/radio/" rel="tag">radio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/recursive/" rel="tag">recursive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/segment-tree/" rel="tag">segment tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shanghai/" rel="tag">shanghai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/" rel="tag">sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/summer/" rel="tag">summer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tail-call/" rel="tag">tail call</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unix/" rel="tag">unix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/young/" rel="tag">young</a></li></ul>

            </section>
        </aside>
    </div>
</body>

</html>